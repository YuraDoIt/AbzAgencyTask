<%- include ("./chablon/head.ejs") %>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <body>
        <%- include ("./chablon/nav.ejs") %>
    
        <div class="container" id="app">
            <main>            
                <div class="row">
                    <div class="col-md-8">
                        <form method="get" action="http://localhost:3000/token">
                            
                            <p>Status: <%= status %></p>
                            <p id="tokenField">Token: <%= token %></p>
                            <p id="test">test</p>
                            <div class="form-group">
                                <button class="btn btn-success" id="submitButton" type="submit">Submit</button>
                            </div>
                        </form>

                
                    </div>
                </div> 
            </main>
        </div>

        <script>
            $(document).ready(function() {
            let token = document.getElementById('tokenField');
            
            let tokenFromDocument = token.textContent.split(' ')[1];
            $('#submitButton').on('click',function(){
            $.ajax({
                  url: "http://localhost:3000/token",
                  type: 'Get',
                  contentType: 'application/json',
                  headers: {
                            "Authorization": "Bearer " + $('#tokenField').val()
                         },
                  async: false,
                    })
                });
            });
        </script>

<%- include ("./chablon/footer.ejs") %>
